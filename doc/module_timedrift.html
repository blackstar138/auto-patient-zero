<!DOCTYPE html><html><head><meta charset="utf-8"><title></title><style type="text/css">body {
  width: 95%;
  max-width: 70%;
  margin: 20px;
  padding: 0;
  background: #151515 url("../images/bkg.png") 0 0;
  color: #eaeaea;
  font: 16px;
  line-height: 1.5em;
  font-family: Monaco, "Bitstream Vera Sans Mono", "Lucida Console", Terminal, monospace;
}

#table-of-contents ul {
    line-height: 1;
}

/* General & 'Reset' Stuff */

.container {
  width: 95%;
  max-width: 1000px;
  margin: 0 auto;
}

section {
  display: block;
  margin: 0 0 20px 0;
}

h1, h2, h3, h4, h5, h6 {
  /*margin: 0 0 20px;*/
  /*margin: 0;*/
}

/* Header, <header>
 *    header   - container
 *       h1       - project name
 *          h2       - project description
 *          */

header {
  background: rgba(0, 0, 0, 0.1);
  width: 100%;
  /*border-bottom: 1px dashed #b5e853;*/
  /*padding: 20px 0;
 *   margin: 0 0 40px 0;*/
  padding: 5px 0;
  margin: 0 0 10px 0;
}

header h1 {
  font-size: 30px;
  line-height: 1.5;
  margin: 0 0 0 -40px;
  font-weight: bold;
  font-family: Monaco, "Bitstream Vera Sans Mono", "Lucida Console", Terminal, monospace;
  /*color: #b5e853;*/
  color: #089d00;
  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1),
               0 0 5px rgba(181, 232, 83, 0.1),
               0 0 10px rgba(181, 232, 83, 0.1);
  letter-spacing: -1px;
  -webkit-font-smoothing: antialiased;
}

header h1:before {
  content: "./ ";
  font-size: 24px;
}

header h2 {
  font-size: 18px;
  font-weight: 300;
}

/* Main Content
 * */

body {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  -webkit-font-smoothing: antialiased;
}
section img {
  max-width: 100%
}

h2 a {
  font-weight: bold;
  color: #8AB638;
  line-height: 1.4em;
  font-size: 1.4em;
}
h3 a, h4 a, h5 a, h6 a {
  font-weight: bold;
  color: #934500;
  line-height: 1.4em;
}

h1 {
  font-size: 30px;
}

h2 {
  font-size: 28px;
  border-bottom: 1px dashed #b5e853;
}

h3 {
  font-size: 18px;
}

h4 {
  font-size: 14px;
}

h5 {
  font-size: 12px;
  text-transform: uppercase;
  margin: 0 0 5px 0;
}

h6 {
  font-size: 12px;
  text-transform: uppercase;
  color: #999;
  margin: 0 0 5px 0;
}

dt {
  font-style: italic;
  font-weight: bold;
}
/*
ul li {
  list-style: none;
}
*/
/*
ul li:before {
  content: ">>";
  font-family: Monaco, "Bitstream Vera Sans Mono", "Lucida Console", Terminal, monospace;
  font-size: 13px;
  color: #b5e853;
  margin-left: -37px;
  margin-right: 21px;
  line-height: 16px;
}
*/

blockquote {
  color: #aaa;
  padding-left: 10px;
  border-left: 1px dotted #666;
}


pre {
  background: rgba(0, 0, 0, 0.9);
  border: 1px solid rgba(255, 255, 255, 0.15);
  padding: 10px;
  font-size: 14px;
  //color: #b5e853;
  border-radius: 2px;
  -moz-border-radius: 2px;
  -webkit-border-radius: 2px;
  text-wrap: normal;
  overflow: auto;
  overflow-y: hidden;
}

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

code .ln { color: grey; } /* line numbers */
/*code, code { background-color: #eeeeee }*/
code .comment, code .comment, code .c1 { color: #999; }
code .keyword, code .keyword, code .kd, code .kn, code .k, code .o { color: #FC8F3F; font-weight: bold;}
code .nb { color: #c45918;}
code .s {color: #0a77c4;}
code .punctuation, code .p { color: white;}
code .literal.string, code .literal.string { color: #40BF32; }
code .name, code .name.builtin, code .nx { color: white; }
code .deleted, code .deleted { background-color: #DEB0A1}
code .inserted, code .inserted { background-color: #A3D289}

table {
  width: 100%;
  margin: 0 0 20px 0;
}

th {
  text-align: left;
  border-bottom: 1px dashed #b5e853;
  padding: 5px 10px;
}

td {
  padding: 5px 10px;
}

hr {
  height: 0;
  border: 0;
  border-bottom: 1px dashed #b5e853;
  color: #b5e853;
}
/* Links
 *    a, a:hover, a:visited
 *    */

a {
  color: #63c0f5;
  /*text-shadow: 0 0 5px rgba(104, 182, 255, 0.5);*/
  text-decoration: none;
}

cite {
  color: #00FF4A;
}

strong {
  color: #C64216;
}
</style></head><body><h1>Mozilla InvestiGator: TimeDrift module</h1><table><tr><td class="field-label">Author</td><td>Julien Vehent &lt;<a class="reference external" href="mailto:jvehent@mozilla.com">jvehent@mozilla.com</a>&gt;</td></tr></table><div class="contents" id="table-of-contents"><h2>Table of Contents</h2><ul class="auto-toc"><li><p><a class="reference internal" href="#usage" id="id1">1   Usage</a></p></li><li><p><a class="reference internal" href="#examples" id="id2">2   Examples</a></p><ul class="auto-toc"><li><p><a class="reference internal" href="#endpoint-non-compliant-with-a-10-millisecond-drift" id="id3">2.1   Endpoint non-compliant with a 10 millisecond drift</a></p></li><li><p><a class="reference internal" href="#endpoint-compliant-with-a-5-seconds-drift" id="id4">2.2   Endpoint compliant with a 5 seconds drift</a></p></li><li><p><a class="reference internal" href="#get-localtime-from-endpoint" id="id5">2.3   Get localtime from endpoint</a></p></li></ul></li></ul></div><p>The timedrift module evaluates the current time on a given endpoint against the
time retrieved from a list of NTP servers. If the -drift parameter is passed,
the module checks that the endpoint's time is within or without the drift
window.</p><p>When evaluating drift, the module returns FoundAnything=true for endpoints that
have drifted beyond the accepted value, and for which the local time is out of
sync compared with NTP servers.</p><section id="usage"><header><h2><a href="#id1">1   Usage</a></h2></header><p>timedrift can be called with empty parameters, and then only returns the local
time of the target endpoint. When called with a drift parameter, NTP
connections are established to evaluated the local time against network time.</p><pre><code class="code json"><span class="punctuation">{</span>
  <span class="name tag">"module"</span><span class="punctuation">:</span> <span class="literal string double">"timedrift"</span><span class="punctuation">,</span>
  <span class="name tag">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span>
        <span class="name tag">"drift"</span><span class="punctuation">:</span> <span class="literal string double">"5s"</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span></code></pre></section><section id="examples"><header><h2><a href="#id2">2   Examples</a></h2></header><section id="endpoint-non-compliant-with-a-10-millisecond-drift"><header><h3><a href="#id3">2.1   Endpoint non-compliant with a 10 millisecond drift</a></h3></header><p>Evaluating a 10ms drift is not useful, because the latency between the
endpoint and the NTP servers is most likely greater than 10ms, and
endpoint would always fail that test. But it illustrates the output
from an endpoint that has drifted beyond the acceptable value.</p><pre><code class="code">$ mig timedrift -t "name='somehost.example.net'" -show all -drift 10ms 2&gt;/dev/null
stat: execution time 252.902127ms
somehost.example.net local time is 2015-03-14T13:26:27.441740604-04:00
somehost.example.net local time is out of sync from NTP servers
somehost.example.net Local time is ahead of ntp host 0.pool.ntp.org by 17.731324ms
somehost.example.net Local time is ahead of ntp host 1.pool.ntp.org by 16.542859ms
somehost.example.net Local time is ahead of ntp host 2.pool.ntp.org by 20.853337ms
somehost.example.net Local time is ahead of ntp host 3.pool.ntp.org by 33.743419ms
somehost.example.net stat: 0.pool.ntp.org responded in 44.26132ms with time 2015-03-14 17:26:27.473289999 +0000 UTC. local time drifts by 17.731324ms
somehost.example.net stat: 1.pool.ntp.org responded in 38.263502ms with time 2015-03-14 17:26:27.520487097 +0000 UTC. local time drifts by 16.542859ms
somehost.example.net stat: 2.pool.ntp.org responded in 46.682002ms with time 2015-03-14 17:26:27.576307275 +0000 UTC. local time drifts by 20.853337ms
somehost.example.net stat: 3.pool.ntp.org responded in 83.492232ms with time 2015-03-14 17:26:27.660943187 +0000 UTC. local time drifts by 33.743419ms
somehost.example.net command success</code></pre></section><section id="endpoint-compliant-with-a-5-seconds-drift"><header><h3><a href="#id4">2.2   Endpoint compliant with a 5 seconds drift</a></h3></header><pre><code class="code">$ mig timedrift -t "name='somehost.example.net'" -show all -drift 5s 2&gt;/dev/null
stat: execution time 1.76047894s
somehost.example.net local time is 2015-03-14T13:26:10.764244879-04:00
somehost.example.net local time is within acceptable drift from NTP servers
somehost.example.net stat: 0.pool.ntp.org responded in 44.574857ms with time 2015-03-14 17:26:10.996919999 +0000 UTC. local time drifts by 17.557879ms
somehost.example.net stat: 1.pool.ntp.org responded in 38.52106ms with time 2015-03-14 17:26:12.139883892 +0000 UTC. local time drifts by 16.917595ms
somehost.example.net stat: 2.pool.ntp.org responded in 46.79544ms with time 2015-03-14 17:26:12.38555022 +0000 UTC. local time drifts by 20.839501ms
somehost.example.net stat: 3.pool.ntp.org responded in 82.798078ms with time 2015-03-14 17:26:12.490975185 +0000 UTC. local time drifts by 33.808416ms
somehost.example.net command success</code></pre></section><section id="get-localtime-from-endpoint"><header><h3><a href="#id5">2.3   Get localtime from endpoint</a></h3></header><pre><code class="code">$ mig timedrift -t "name='somehost.example.net'" 2&gt;/dev/null
somehost.example.net local time is 2015-03-14T13:32:24.226318523-04:00</code></pre></section></section></body></html>